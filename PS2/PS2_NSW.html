<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="1093122">

<title>PS2_NSW</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="PS2_NSW_files/libs/clipboard/clipboard.min.js"></script>
<script src="PS2_NSW_files/libs/quarto-html/quarto.js"></script>
<script src="PS2_NSW_files/libs/quarto-html/popper.min.js"></script>
<script src="PS2_NSW_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PS2_NSW_files/libs/quarto-html/anchor.min.js"></script>
<link href="PS2_NSW_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PS2_NSW_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PS2_NSW_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PS2_NSW_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PS2_NSW_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PS2_NSW</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>1093122 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="exercise-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1">Exercise 1</h2>
<section id="a." class="level3">
<h3 class="anchored" data-anchor-id="a.">a.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"https://users.nber.org/~rdehejia/data/nsw_dw.dta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b." class="level3">
<h3 class="anchored" data-anchor-id="b.">b.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">earnings74 =</span> re74,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">earnings75 =</span> re75,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">earnings78 =</span> re78)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>experimental</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 445 × 11
   data_id      treat   age education black hispanic married nodegree earnings74
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 Dehejia-Wah…     1    37        11     1        0       1        1          0
 2 Dehejia-Wah…     1    22         9     0        1       0        1          0
 3 Dehejia-Wah…     1    30        12     1        0       0        0          0
 4 Dehejia-Wah…     1    27        11     1        0       0        1          0
 5 Dehejia-Wah…     1    33         8     1        0       0        1          0
 6 Dehejia-Wah…     1    22         9     1        0       0        1          0
 7 Dehejia-Wah…     1    23        12     1        0       0        0          0
 8 Dehejia-Wah…     1    32        11     1        0       0        1          0
 9 Dehejia-Wah…     1    22        16     1        0       0        0          0
10 Dehejia-Wah…     1    33        12     0        0       1        0          0
# ℹ 435 more rows
# ℹ 2 more variables: earnings75 &lt;dbl&gt;, earnings78 &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="c." class="level3">
<h3 class="anchored" data-anchor-id="c.">c.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">case_when</span>(black <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                          hispanic <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"hispanic"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"white"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>black, <span class="sc">-</span>hispanic)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>experimental</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 445 × 10
   data_id          treat   age education married nodegree earnings74 earnings75
   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Dehejia-Wahba S…     1    37        11       1        1          0          0
 2 Dehejia-Wahba S…     1    22         9       0        1          0          0
 3 Dehejia-Wahba S…     1    30        12       0        0          0          0
 4 Dehejia-Wahba S…     1    27        11       0        1          0          0
 5 Dehejia-Wahba S…     1    33         8       0        1          0          0
 6 Dehejia-Wahba S…     1    22         9       0        1          0          0
 7 Dehejia-Wahba S…     1    23        12       0        0          0          0
 8 Dehejia-Wahba S…     1    32        11       0        1          0          0
 9 Dehejia-Wahba S…     1    22        16       0        0          0          0
10 Dehejia-Wahba S…     1    33        12       1        0          0          0
# ℹ 435 more rows
# ℹ 2 more variables: earnings78 &lt;dbl&gt;, race &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="d." class="level3">
<h3 class="anchored" data-anchor-id="d.">d.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">ifelse</span>(treat <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"treated"</span>, <span class="st">"non_treated"</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">degree =</span> <span class="fu">ifelse</span>(nodegree <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"no_high_school"</span>, <span class="st">"high_school"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">marriage =</span> <span class="fu">ifelse</span>(married, <span class="st">"married"</span>, <span class="st">"unmarried"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>nodegree, <span class="sc">-</span>married)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>experimental</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 445 × 10
   data_id   treat   age education earnings74 earnings75 earnings78 race  degree
   &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Dehejia-… trea…    37        11          0          0      9930. black no_hi…
 2 Dehejia-… trea…    22         9          0          0      3596. hisp… no_hi…
 3 Dehejia-… trea…    30        12          0          0     24909. black high_…
 4 Dehejia-… trea…    27        11          0          0      7506. black no_hi…
 5 Dehejia-… trea…    33         8          0          0       290. black no_hi…
 6 Dehejia-… trea…    22         9          0          0      4056. black no_hi…
 7 Dehejia-… trea…    23        12          0          0         0  black high_…
 8 Dehejia-… trea…    32        11          0          0      8472. black no_hi…
 9 Dehejia-… trea…    22        16          0          0      2164. black high_…
10 Dehejia-… trea…    33        12          0          0     12418. white high_…
# ℹ 435 more rows
# ℹ 1 more variable: marriage &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="e." class="level3">
<h3 class="anchored" data-anchor-id="e.">e.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">employment74 =</span> <span class="fu">ifelse</span>(earnings74<span class="sc">==</span><span class="dv">0</span>, <span class="st">"unemployed"</span>, <span class="st">"employed"</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">employement75 =</span> <span class="fu">ifelse</span>(earnings75<span class="sc">==</span><span class="dv">0</span>, <span class="st">"unemployed"</span>, <span class="st">"employed"</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>experimental</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 445 × 12
   data_id   treat   age education earnings74 earnings75 earnings78 race  degree
   &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Dehejia-… trea…    37        11          0          0      9930. black no_hi…
 2 Dehejia-… trea…    22         9          0          0      3596. hisp… no_hi…
 3 Dehejia-… trea…    30        12          0          0     24909. black high_…
 4 Dehejia-… trea…    27        11          0          0      7506. black no_hi…
 5 Dehejia-… trea…    33         8          0          0       290. black no_hi…
 6 Dehejia-… trea…    22         9          0          0      4056. black no_hi…
 7 Dehejia-… trea…    23        12          0          0         0  black high_…
 8 Dehejia-… trea…    32        11          0          0      8472. black no_hi…
 9 Dehejia-… trea…    22        16          0          0      2164. black high_…
10 Dehejia-… trea…    33        12          0          0     12418. white high_…
# ℹ 435 more rows
# ℹ 3 more variables: marriage &lt;chr&gt;, employment74 &lt;chr&gt;, employement75 &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="f." class="level3">
<h3 class="anchored" data-anchor-id="f.">f.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data_id)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>experimental</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 445 × 11
   treat    age education earnings74 earnings75 earnings78 race  degree marriage
   &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   
 1 treat…    37        11          0          0      9930. black no_hi… married 
 2 treat…    22         9          0          0      3596. hisp… no_hi… unmarri…
 3 treat…    30        12          0          0     24909. black high_… unmarri…
 4 treat…    27        11          0          0      7506. black no_hi… unmarri…
 5 treat…    33         8          0          0       290. black no_hi… unmarri…
 6 treat…    22         9          0          0      4056. black no_hi… unmarri…
 7 treat…    23        12          0          0         0  black high_… unmarri…
 8 treat…    32        11          0          0      8472. black no_hi… unmarri…
 9 treat…    22        16          0          0      2164. black high_… unmarri…
10 treat…    33        12          0          0     12418. white high_… married 
# ℹ 435 more rows
# ℹ 2 more variables: employment74 &lt;chr&gt;, employement75 &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the cleanup function for data cleaning later</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cleanup <span class="ot">&lt;-</span> <span class="cf">function</span>(experimental){</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">earnings74 =</span> re74,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">earnings75 =</span> re75,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">earnings78 =</span> re78)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">case_when</span>(black <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"black"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                          hispanic <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"hispanic"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"white"</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>black, <span class="sc">-</span>hispanic)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">ifelse</span>(treat <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"treated"</span>, <span class="st">"non_treated"</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">degree =</span> <span class="fu">ifelse</span>(nodegree <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"no_high_school"</span>, <span class="st">"high_school"</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">marriage =</span> <span class="fu">ifelse</span>(married, <span class="st">"married"</span>, <span class="st">"unmarried"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">|&gt;</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>nodegree, <span class="sc">-</span>married)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">employment74 =</span> <span class="fu">ifelse</span>(earnings74<span class="sc">==</span><span class="dv">0</span>, <span class="st">"unemployed"</span>, <span class="st">"employed"</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">employement75 =</span> <span class="fu">ifelse</span>(earnings75<span class="sc">==</span><span class="dv">0</span>, <span class="st">"unemployed"</span>, <span class="st">"employed"</span>))</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  experimental <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data_id)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercise-2" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2">Exercise 2</h2>
<section id="a.-1" class="level3">
<h3 class="anchored" data-anchor-id="a.-1">a.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(experimental, <span class="at">type =</span> <span class="st">"numeric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_cscug6g8mg0lylxe179h(i, j, css_id) {
          var table = document.getElementById("tinytable_cscug6g8mg0lylxe179h");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_cscug6g8mg0lylxe179h');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_cscug6g8mg0lylxe179h(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_cscug6g8mg0lylxe179h");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 5, j: 6 }, { i: 5, j: 4 }, { i: 5, j: 2 }, { i: 5, j: 0 }, { i: 5, j: 3 }, { i: 5, j: 1 }, { i: 5, j: 7 }, { i: 5, j: 5 }, { i: 5, j: 8 },  ], css_id: 'tinytable_css_l00045b8ma7u8yevtv79',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 1, j: 2 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 1, j: 6 }, { i: 1, j: 4 }, { i: 2, j: 4 }, { i: 3, j: 4 }, { i: 4, j: 4 }, { i: 4, j: 2 }, { i: 1, j: 7 }, { i: 2, j: 7 }, { i: 2, j: 5 }, { i: 3, j: 5 }, { i: 4, j: 5 }, { i: 4, j: 3 }, { i: 1, j: 8 }, { i: 2, j: 8 }, { i: 2, j: 6 }, { i: 3, j: 6 }, { i: 4, j: 6 }, { i: 3, j: 7 }, { i: 4, j: 7 }, { i: 3, j: 8 }, { i: 4, j: 8 },  ], css_id: 'tinytable_css_591fxklmrl04kaplacsw',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 3 }, { i: 0, j: 1 }, { i: 0, j: 7 }, { i: 0, j: 5 }, { i: 0, j: 8 }, { i: 0, j: 6 }, { i: 0, j: 4 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_qil25og1lxn7ffbpo3re',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_cscug6g8mg0lylxe179h(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_l00045b8ma7u8yevtv79, .table th.tinytable_css_l00045b8ma7u8yevtv79 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_591fxklmrl04kaplacsw, .table th.tinytable_css_591fxklmrl04kaplacsw { text-align: left; }
      .table td.tinytable_css_qil25og1lxn7ffbpo3re, .table th.tinytable_css_qil25og1lxn7ffbpo3re { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_cscug6g8mg0lylxe179h" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Unique</th>
                <th scope="col">Missing Pct.</th>
                <th scope="col">Mean</th>
                <th scope="col">SD</th>
                <th scope="col">Min</th>
                <th scope="col">Median</th>
                <th scope="col">Max</th>
                <th scope="col">Histogram</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>age</td>
                  <td>34</td>
                  <td>0</td>
                  <td>25.4</td>
                  <td>7.1</td>
                  <td>17.0</td>
                  <td>24.0</td>
                  <td>55.0</td>
                  <td><img src="./tinytable_assets/idf2ev0zsmkkhsjkwm4pux.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>education</td>
                  <td>14</td>
                  <td>0</td>
                  <td>10.2</td>
                  <td>1.8</td>
                  <td>3.0</td>
                  <td>10.0</td>
                  <td>16.0</td>
                  <td><img src="./tinytable_assets/id2bt8waed2pgxuwp76ow8.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>earnings74</td>
                  <td>115</td>
                  <td>0</td>
                  <td>2102.3</td>
                  <td>5363.6</td>
                  <td>0.0</td>
                  <td>0.0</td>
                  <td>39570.7</td>
                  <td><img src="./tinytable_assets/idersqwxswqchjxx0jcehf.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>earnings75</td>
                  <td>155</td>
                  <td>0</td>
                  <td>1377.1</td>
                  <td>3151.0</td>
                  <td>0.0</td>
                  <td>0.0</td>
                  <td>25142.2</td>
                  <td><img src="./tinytable_assets/idqin295g4baky0zlogd3n.png" style="height: 1em;"></td>
                </tr>
                <tr>
                  <td>earnings78</td>
                  <td>308</td>
                  <td>0</td>
                  <td>5300.8</td>
                  <td>6631.5</td>
                  <td>0.0</td>
                  <td>3701.8</td>
                  <td>60307.9</td>
                  <td><img src="./tinytable_assets/idhio206xvs30n7ojjsa47.png" style="height: 1em;"></td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(experimental, <span class="at">type =</span> <span class="st">"categorical"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_2n5cyg3ogcn4gs3m2yhp(i, j, css_id) {
          var table = document.getElementById("tinytable_2n5cyg3ogcn4gs3m2yhp");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_2n5cyg3ogcn4gs3m2yhp');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_2n5cyg3ogcn4gs3m2yhp(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_2n5cyg3ogcn4gs3m2yhp");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 13, j: 2 }, { i: 13, j: 3 },  ], css_id: 'tinytable_css_6upnlzfgizgpaq8u50mu',}, 
          { positions: [ { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 }, { i: 10, j: 2 }, { i: 11, j: 2 }, { i: 12, j: 2 }, { i: 12, j: 3 }, { i: 1, j: 2 }, { i: 1, j: 3 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 4, j: 3 }, { i: 5, j: 3 }, { i: 6, j: 3 }, { i: 7, j: 3 }, { i: 8, j: 3 }, { i: 9, j: 3 }, { i: 10, j: 3 }, { i: 11, j: 3 },  ], css_id: 'tinytable_css_ebufpe270irx7vn8k878',}, 
          { positions: [ { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_ii1eott7i8qb0y8phl8l',}, 
          { positions: [ { i: 13, j: 0 }, { i: 13, j: 1 },  ], css_id: 'tinytable_css_jv1khobfn7muccolbl4f',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 }, { i: 12, j: 0 }, { i: 12, j: 1 }, { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 10, j: 1 }, { i: 11, j: 1 },  ], css_id: 'tinytable_css_swa3hfbz0tin65jew7ew',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 },  ], css_id: 'tinytable_css_13yrewa5bsfqgmxjqmx2',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_2n5cyg3ogcn4gs3m2yhp(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_6upnlzfgizgpaq8u50mu, .table th.tinytable_css_6upnlzfgizgpaq8u50mu { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_ebufpe270irx7vn8k878, .table th.tinytable_css_ebufpe270irx7vn8k878 { text-align: right; }
      .table td.tinytable_css_ii1eott7i8qb0y8phl8l, .table th.tinytable_css_ii1eott7i8qb0y8phl8l { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_jv1khobfn7muccolbl4f, .table th.tinytable_css_jv1khobfn7muccolbl4f { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_swa3hfbz0tin65jew7ew, .table th.tinytable_css_swa3hfbz0tin65jew7ew { text-align: left; }
      .table td.tinytable_css_13yrewa5bsfqgmxjqmx2, .table th.tinytable_css_13yrewa5bsfqgmxjqmx2 { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_2n5cyg3ogcn4gs3m2yhp" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">  </th>
                <th scope="col">N</th>
                <th scope="col">%</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>treat</td>
                  <td>non_treated</td>
                  <td>260</td>
                  <td>58.4</td>
                </tr>
                <tr>
                  <td></td>
                  <td>treated</td>
                  <td>185</td>
                  <td>41.6</td>
                </tr>
                <tr>
                  <td>race</td>
                  <td>black</td>
                  <td>371</td>
                  <td>83.4</td>
                </tr>
                <tr>
                  <td></td>
                  <td>hispanic</td>
                  <td>39</td>
                  <td>8.8</td>
                </tr>
                <tr>
                  <td></td>
                  <td>white</td>
                  <td>35</td>
                  <td>7.9</td>
                </tr>
                <tr>
                  <td>degree</td>
                  <td>high_school</td>
                  <td>97</td>
                  <td>21.8</td>
                </tr>
                <tr>
                  <td></td>
                  <td>no_high_school</td>
                  <td>348</td>
                  <td>78.2</td>
                </tr>
                <tr>
                  <td>marriage</td>
                  <td>married</td>
                  <td>75</td>
                  <td>16.9</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unmarried</td>
                  <td>370</td>
                  <td>83.1</td>
                </tr>
                <tr>
                  <td>employment74</td>
                  <td>employed</td>
                  <td>119</td>
                  <td>26.7</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unemployed</td>
                  <td>326</td>
                  <td>73.3</td>
                </tr>
                <tr>
                  <td>employement75</td>
                  <td>employed</td>
                  <td>156</td>
                  <td>35.1</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unemployed</td>
                  <td>289</td>
                  <td>64.9</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="b.-1" class="level3">
<h3 class="anchored" data-anchor-id="b.-1">b.</h3>
<p>The two groups are similar in terms of their average age, education and earnings in 1974. The average earnings for the treated group are slightly higher in 1975 and much higher in 1978 than the untreated group. The race composition in treated and untreated groups are similar while there is a slightly higher proportion of hispanic people and a lower proportion of white people in the non-treated group. A higher proportion of people in the treated group have high school degreee compared with the non-treated group. The two groups also have similar marriage patterns and employment status in 1974. In 1975, a higher proportion of people from the treated group are employed. There seems to be no obvious selection bias based on observable characteristics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_balance</span>(experimental</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                    <span class="sc">~</span> treat, <span class="at">data =</span> experimental)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Please install the `estimatr` package or set `dinm=FALSE` to suppress
this warning.</code></pre>
</div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_bbn7jjma5he2heclcyux(i, j, css_id) {
          var table = document.getElementById("tinytable_bbn7jjma5he2heclcyux");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_bbn7jjma5he2heclcyux');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_bbn7jjma5he2heclcyux(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_bbn7jjma5he2heclcyux");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 4 }, { i: 0, j: 5 },  ], css_id: 'tinytable_css_l8i4f1p7u8mhiv7a13xe',}, 
          { positions: [ { i: 18, j: 3 }, { i: 18, j: 4 }, { i: 18, j: 5 }, { i: 18, j: 2 },  ], css_id: 'tinytable_css_6sm6p067483ftxtu7bx0',}, 
          { positions: [ { i: 6, j: 4 }, { i: 6, j: 5 }, { i: 6, j: 2 }, { i: 6, j: 3 },  ], css_id: 'tinytable_css_t7yldeb596r7m7ljhhfq',}, 
          { positions: [ { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 9, j: 2 }, { i: 10, j: 2 }, { i: 11, j: 2 }, { i: 8, j: 2 }, { i: 13, j: 2 }, { i: 14, j: 2 }, { i: 15, j: 2 }, { i: 16, j: 2 }, { i: 17, j: 2 }, { i: 5, j: 2 }, { i: 13, j: 3 }, { i: 7, j: 2 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 4, j: 3 }, { i: 5, j: 3 }, { i: 12, j: 2 }, { i: 7, j: 3 }, { i: 8, j: 3 }, { i: 9, j: 3 }, { i: 10, j: 3 }, { i: 11, j: 3 }, { i: 12, j: 3 }, { i: 7, j: 4 }, { i: 14, j: 3 }, { i: 15, j: 3 }, { i: 16, j: 3 }, { i: 17, j: 3 }, { i: 12, j: 4 }, { i: 13, j: 4 }, { i: 14, j: 4 }, { i: 2, j: 4 }, { i: 3, j: 4 }, { i: 4, j: 4 }, { i: 5, j: 4 }, { i: 13, j: 5 }, { i: 14, j: 5 }, { i: 8, j: 4 }, { i: 9, j: 4 }, { i: 10, j: 4 }, { i: 11, j: 4 }, { i: 16, j: 4 }, { i: 7, j: 5 }, { i: 8, j: 5 }, { i: 15, j: 4 }, { i: 5, j: 5 }, { i: 17, j: 4 }, { i: 12, j: 5 }, { i: 4, j: 5 }, { i: 9, j: 5 }, { i: 2, j: 5 }, { i: 3, j: 5 }, { i: 16, j: 5 }, { i: 17, j: 5 }, { i: 10, j: 5 }, { i: 11, j: 5 }, { i: 15, j: 5 },  ], css_id: 'tinytable_css_sf0otf20hs782dl01q2s',}, 
          { positions: [ { i: 0, j: 3 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_1d7gck0egqydet6nl1ob',}, 
          { positions: [ { i: 1, j: 2 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 1, j: 4 },  ], css_id: 'tinytable_css_aom1n7nhcqua6l43rypf',}, 
          { positions: [ { i: 18, j: 0 }, { i: 18, j: 1 },  ], css_id: 'tinytable_css_uuo227ftt70otholw79v',}, 
          { positions: [ { i: 6, j: 1 }, { i: 6, j: 0 },  ], css_id: 'tinytable_css_viewcwk09all6fwnvk2m',}, 
          { positions: [ { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 }, { i: 12, j: 0 }, { i: 13, j: 0 }, { i: 14, j: 0 }, { i: 15, j: 0 }, { i: 16, j: 0 }, { i: 17, j: 0 }, { i: 12, j: 1 }, { i: 13, j: 1 }, { i: 7, j: 0 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 10, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 14, j: 1 }, { i: 11, j: 1 }, { i: 16, j: 1 }, { i: 17, j: 1 }, { i: 15, j: 1 },  ], css_id: 'tinytable_css_x08fo785dq8w5noa20rl',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 },  ], css_id: 'tinytable_css_hs0ww1ul01av8qh8bjok',}, 
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 },  ], css_id: 'tinytable_css_859o0bwuzg1zt89qkg2e',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_bbn7jjma5he2heclcyux(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_l8i4f1p7u8mhiv7a13xe, .table th.tinytable_css_l8i4f1p7u8mhiv7a13xe { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_6sm6p067483ftxtu7bx0, .table th.tinytable_css_6sm6p067483ftxtu7bx0 { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_t7yldeb596r7m7ljhhfq, .table th.tinytable_css_t7yldeb596r7m7ljhhfq { text-align: right; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_sf0otf20hs782dl01q2s, .table th.tinytable_css_sf0otf20hs782dl01q2s { text-align: right; }
      .table td.tinytable_css_1d7gck0egqydet6nl1ob, .table th.tinytable_css_1d7gck0egqydet6nl1ob { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_aom1n7nhcqua6l43rypf, .table th.tinytable_css_aom1n7nhcqua6l43rypf { text-align: right; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_uuo227ftt70otholw79v, .table th.tinytable_css_uuo227ftt70otholw79v { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_viewcwk09all6fwnvk2m, .table th.tinytable_css_viewcwk09all6fwnvk2m { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_x08fo785dq8w5noa20rl, .table th.tinytable_css_x08fo785dq8w5noa20rl { text-align: left; }
      .table td.tinytable_css_hs0ww1ul01av8qh8bjok, .table th.tinytable_css_hs0ww1ul01av8qh8bjok { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_859o0bwuzg1zt89qkg2e, .table th.tinytable_css_859o0bwuzg1zt89qkg2e { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_bbn7jjma5he2heclcyux" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="2">non_treated (N=260)</th>
<th scope="col" align="center" colspan="2">treated (N=185)</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">  </th>
                <th scope="col">Mean</th>
                <th scope="col">Std. Dev.</th>
                <th scope="col">Mean</th>
                <th scope="col">Std. Dev.</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>age</td>
                  <td></td>
                  <td>25.1</td>
                  <td>7.1</td>
                  <td>25.8</td>
                  <td>7.2</td>
                </tr>
                <tr>
                  <td>education</td>
                  <td></td>
                  <td>10.1</td>
                  <td>1.6</td>
                  <td>10.3</td>
                  <td>2.0</td>
                </tr>
                <tr>
                  <td>earnings74</td>
                  <td></td>
                  <td>2107.0</td>
                  <td>5687.9</td>
                  <td>2095.6</td>
                  <td>4886.6</td>
                </tr>
                <tr>
                  <td>earnings75</td>
                  <td></td>
                  <td>1266.9</td>
                  <td>3103.0</td>
                  <td>1532.1</td>
                  <td>3219.3</td>
                </tr>
                <tr>
                  <td>earnings78</td>
                  <td></td>
                  <td>4554.8</td>
                  <td>5483.8</td>
                  <td>6349.1</td>
                  <td>7867.4</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>N</td>
                  <td>Pct.</td>
                  <td>N</td>
                  <td>Pct.</td>
                </tr>
                <tr>
                  <td>race</td>
                  <td>black</td>
                  <td>215</td>
                  <td>82.7</td>
                  <td>156</td>
                  <td>84.3</td>
                </tr>
                <tr>
                  <td></td>
                  <td>hispanic</td>
                  <td>28</td>
                  <td>10.8</td>
                  <td>11</td>
                  <td>5.9</td>
                </tr>
                <tr>
                  <td></td>
                  <td>white</td>
                  <td>17</td>
                  <td>6.5</td>
                  <td>18</td>
                  <td>9.7</td>
                </tr>
                <tr>
                  <td>degree</td>
                  <td>high_school</td>
                  <td>43</td>
                  <td>16.5</td>
                  <td>54</td>
                  <td>29.2</td>
                </tr>
                <tr>
                  <td></td>
                  <td>no_high_school</td>
                  <td>217</td>
                  <td>83.5</td>
                  <td>131</td>
                  <td>70.8</td>
                </tr>
                <tr>
                  <td>marriage</td>
                  <td>married</td>
                  <td>40</td>
                  <td>15.4</td>
                  <td>35</td>
                  <td>18.9</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unmarried</td>
                  <td>220</td>
                  <td>84.6</td>
                  <td>150</td>
                  <td>81.1</td>
                </tr>
                <tr>
                  <td>employment74</td>
                  <td>employed</td>
                  <td>65</td>
                  <td>25.0</td>
                  <td>54</td>
                  <td>29.2</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unemployed</td>
                  <td>195</td>
                  <td>75.0</td>
                  <td>131</td>
                  <td>70.8</td>
                </tr>
                <tr>
                  <td>employement75</td>
                  <td>employed</td>
                  <td>82</td>
                  <td>31.5</td>
                  <td>74</td>
                  <td>40.0</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unemployed</td>
                  <td>178</td>
                  <td>68.5</td>
                  <td>111</td>
                  <td>60.0</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="c.-1" class="level3">
<h3 class="anchored" data-anchor-id="c.-1">c.</h3>
<p>The entire 95% confidence interval lies above 0. This indicates the NSW program significantly increased participants’ earnings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the group means for the treated and non-treated group</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treat) <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_earnings78 =</span> <span class="fu">mean</span>(earnings78),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(earnings78)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute ATE</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>ate <span class="ot">&lt;-</span> group_means<span class="sc">$</span>mean_earnings78[<span class="dv">2</span>] <span class="sc">-</span> group_means<span class="sc">$</span>mean_earnings78[<span class="dv">1</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pooled standard error</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>se_ate <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(group_means<span class="sc">$</span>se<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct confidence interval</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> ate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_ate</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>ci_higher <span class="ot">&lt;-</span> ate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_ate</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">ci_lower =</span> ci_lower, <span class="at">ci_higher =</span> ci_higher)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>ci</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> ci_lower ci_higher 
 479.1892  479.1892 </code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-3" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3">Exercise 3</h2>
<section id="a.-2" class="level3">
<h3 class="anchored" data-anchor-id="a.-2">a.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cps_controls <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"https://users.nber.org/~rdehejia/data/cps_controls.dta"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cps_controls</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15,992 × 11
   data_id treat   age education black hispanic married nodegree   re74   re75
   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 CPS1        0    45        11     0        0       1        1 21517. 25244.
 2 CPS1        0    21        14     0        0       0        0  3176.  5853.
 3 CPS1        0    38        12     0        0       1        0 23039. 25131.
 4 CPS1        0    48         6     0        0       1        1 24994. 25244.
 5 CPS1        0    18         8     0        0       1        1  1669. 10728.
 6 CPS1        0    22        11     0        0       1        1 16366. 18449.
 7 CPS1        0    48        10     0        0       1        1 16805. 16355.
 8 CPS1        0    18        11     0        0       0        1  1144.  3620.
 9 CPS1        0    48         9     0        0       1        1 25862. 25244.
10 CPS1        0    45        12     0        0       1        0 25862.     0 
# ℹ 15,982 more rows
# ℹ 1 more variable: re78 &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="b.-2" class="level3">
<h3 class="anchored" data-anchor-id="b.-2">b.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cps_controls <span class="ot">&lt;-</span> <span class="fu">cleanup</span>(cps_controls)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cps_controls</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15,992 × 11
   treat    age education earnings74 earnings75 earnings78 race  degree marriage
   &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   
 1 non_t…    45        11     21517.     25244.     25565. white no_hi… married 
 2 non_t…    21        14      3176.      5853.     13496. white high_… unmarri…
 3 non_t…    38        12     23039.     25131.     25565. white high_… married 
 4 non_t…    48         6     24994.     25244.     25565. white no_hi… married 
 5 non_t…    18         8      1669.     10728.      9861. white no_hi… married 
 6 non_t…    22        11     16366.     18449.     25565. white no_hi… married 
 7 non_t…    48        10     16805.     16355.     18059. white no_hi… married 
 8 non_t…    18        11      1144.      3620.     15739. white no_hi… unmarri…
 9 non_t…    48         9     25862.     25244.     25565. white no_hi… married 
10 non_t…    45        12     25862.         0       3925. white high_… married 
# ℹ 15,982 more rows
# ℹ 2 more variables: employment74 &lt;chr&gt;, employement75 &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="c.-2" class="level3">
<h3 class="anchored" data-anchor-id="c.-2">c.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>experimental_treated <span class="ot">&lt;-</span> experimental <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treat <span class="sc">==</span> <span class="st">"treated"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>composite <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cps_controls, experimental_treated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="d.-1" class="level3">
<h3 class="anchored" data-anchor-id="d.-1">d.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>balance_table <span class="ot">&lt;-</span> <span class="fu">datasummary_balance</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> treat,  <span class="co"># Compare groups</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> composite,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Balance Table: NSW-treated vs CPS-controls"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dinm =</span> <span class="cn">FALSE</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>balance_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_e7cm207ra9b82nps9ep1(i, j, css_id) {
          var table = document.getElementById("tinytable_e7cm207ra9b82nps9ep1");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_e7cm207ra9b82nps9ep1');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_e7cm207ra9b82nps9ep1(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_e7cm207ra9b82nps9ep1");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 4 }, { i: 0, j: 5 },  ], css_id: 'tinytable_css_92bkdl5qi37ilxn1zhds',}, 
          { positions: [ { i: 18, j: 3 }, { i: 18, j: 4 }, { i: 18, j: 5 }, { i: 18, j: 2 },  ], css_id: 'tinytable_css_8nsn6ebso998if63i54r',}, 
          { positions: [ { i: 6, j: 4 }, { i: 6, j: 5 }, { i: 6, j: 2 }, { i: 6, j: 3 },  ], css_id: 'tinytable_css_8l4h9pyj0pvp46kx4b8d',}, 
          { positions: [ { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 9, j: 2 }, { i: 10, j: 2 }, { i: 11, j: 2 }, { i: 8, j: 2 }, { i: 13, j: 2 }, { i: 14, j: 2 }, { i: 15, j: 2 }, { i: 16, j: 2 }, { i: 17, j: 2 }, { i: 5, j: 2 }, { i: 13, j: 3 }, { i: 7, j: 2 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 4, j: 3 }, { i: 5, j: 3 }, { i: 12, j: 2 }, { i: 7, j: 3 }, { i: 8, j: 3 }, { i: 9, j: 3 }, { i: 10, j: 3 }, { i: 11, j: 3 }, { i: 12, j: 3 }, { i: 7, j: 4 }, { i: 14, j: 3 }, { i: 15, j: 3 }, { i: 16, j: 3 }, { i: 17, j: 3 }, { i: 12, j: 4 }, { i: 13, j: 4 }, { i: 14, j: 4 }, { i: 2, j: 4 }, { i: 3, j: 4 }, { i: 4, j: 4 }, { i: 5, j: 4 }, { i: 13, j: 5 }, { i: 14, j: 5 }, { i: 8, j: 4 }, { i: 9, j: 4 }, { i: 10, j: 4 }, { i: 11, j: 4 }, { i: 16, j: 4 }, { i: 7, j: 5 }, { i: 8, j: 5 }, { i: 15, j: 4 }, { i: 5, j: 5 }, { i: 17, j: 4 }, { i: 12, j: 5 }, { i: 4, j: 5 }, { i: 9, j: 5 }, { i: 2, j: 5 }, { i: 3, j: 5 }, { i: 16, j: 5 }, { i: 17, j: 5 }, { i: 10, j: 5 }, { i: 11, j: 5 }, { i: 15, j: 5 },  ], css_id: 'tinytable_css_sgs72ij6ekxzgrpchc1z',}, 
          { positions: [ { i: 0, j: 3 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_nwao3ohposlqezzkdh4c',}, 
          { positions: [ { i: 1, j: 2 }, { i: 1, j: 5 }, { i: 1, j: 3 }, { i: 1, j: 4 },  ], css_id: 'tinytable_css_pwdjhdw4mug1nkj2wy0j',}, 
          { positions: [ { i: 18, j: 0 }, { i: 18, j: 1 },  ], css_id: 'tinytable_css_5fnl16oupta0e9mb2fg9',}, 
          { positions: [ { i: 6, j: 1 }, { i: 6, j: 0 },  ], css_id: 'tinytable_css_r2nnbqvlb7kycdo6pzsl',}, 
          { positions: [ { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 }, { i: 12, j: 0 }, { i: 13, j: 0 }, { i: 14, j: 0 }, { i: 15, j: 0 }, { i: 16, j: 0 }, { i: 17, j: 0 }, { i: 12, j: 1 }, { i: 13, j: 1 }, { i: 7, j: 0 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 10, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 14, j: 1 }, { i: 11, j: 1 }, { i: 16, j: 1 }, { i: 17, j: 1 }, { i: 15, j: 1 },  ], css_id: 'tinytable_css_u3ua2rvmcr0qovksxv9w',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 },  ], css_id: 'tinytable_css_fbak5gtdasmo1e5lnlri',}, 
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 },  ], css_id: 'tinytable_css_qwgmnydu9lr1639zbpqv',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_e7cm207ra9b82nps9ep1(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_92bkdl5qi37ilxn1zhds, .table th.tinytable_css_92bkdl5qi37ilxn1zhds { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_8nsn6ebso998if63i54r, .table th.tinytable_css_8nsn6ebso998if63i54r { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_8l4h9pyj0pvp46kx4b8d, .table th.tinytable_css_8l4h9pyj0pvp46kx4b8d { text-align: right; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_sgs72ij6ekxzgrpchc1z, .table th.tinytable_css_sgs72ij6ekxzgrpchc1z { text-align: right; }
      .table td.tinytable_css_nwao3ohposlqezzkdh4c, .table th.tinytable_css_nwao3ohposlqezzkdh4c { text-align: right; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_pwdjhdw4mug1nkj2wy0j, .table th.tinytable_css_pwdjhdw4mug1nkj2wy0j { text-align: right; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_5fnl16oupta0e9mb2fg9, .table th.tinytable_css_5fnl16oupta0e9mb2fg9 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_r2nnbqvlb7kycdo6pzsl, .table th.tinytable_css_r2nnbqvlb7kycdo6pzsl { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_u3ua2rvmcr0qovksxv9w, .table th.tinytable_css_u3ua2rvmcr0qovksxv9w { text-align: left; }
      .table td.tinytable_css_fbak5gtdasmo1e5lnlri, .table th.tinytable_css_fbak5gtdasmo1e5lnlri { text-align: left; text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_qwgmnydu9lr1639zbpqv, .table th.tinytable_css_qwgmnydu9lr1639zbpqv { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_e7cm207ra9b82nps9ep1" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="2">non_treated (N=15992)</th>
<th scope="col" align="center" colspan="2">treated (N=185)</th>
</tr>
        </thead><caption>Balance Table: NSW-treated vs CPS-controls</caption>
              <tbody><tr>
                <th scope="col"> </th>
                <th scope="col">  </th>
                <th scope="col">Mean</th>
                <th scope="col">Std. Dev.</th>
                <th scope="col">Mean</th>
                <th scope="col">Std. Dev.</th>
              </tr>
        
        
        </tbody><tbody>
                <tr>
                  <td>age</td>
                  <td></td>
                  <td>33.2</td>
                  <td>11.0</td>
                  <td>25.8</td>
                  <td>7.2</td>
                </tr>
                <tr>
                  <td>education</td>
                  <td></td>
                  <td>12.0</td>
                  <td>2.9</td>
                  <td>10.3</td>
                  <td>2.0</td>
                </tr>
                <tr>
                  <td>earnings74</td>
                  <td></td>
                  <td>14016.8</td>
                  <td>9569.8</td>
                  <td>2095.6</td>
                  <td>4886.6</td>
                </tr>
                <tr>
                  <td>earnings75</td>
                  <td></td>
                  <td>13650.8</td>
                  <td>9270.4</td>
                  <td>1532.1</td>
                  <td>3219.3</td>
                </tr>
                <tr>
                  <td>earnings78</td>
                  <td></td>
                  <td>14846.7</td>
                  <td>9647.4</td>
                  <td>6349.1</td>
                  <td>7867.4</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>N</td>
                  <td>Pct.</td>
                  <td>N</td>
                  <td>Pct.</td>
                </tr>
                <tr>
                  <td>race</td>
                  <td>black</td>
                  <td>1176</td>
                  <td>7.4</td>
                  <td>156</td>
                  <td>84.3</td>
                </tr>
                <tr>
                  <td></td>
                  <td>hispanic</td>
                  <td>1152</td>
                  <td>7.2</td>
                  <td>11</td>
                  <td>5.9</td>
                </tr>
                <tr>
                  <td></td>
                  <td>white</td>
                  <td>13664</td>
                  <td>85.4</td>
                  <td>18</td>
                  <td>9.7</td>
                </tr>
                <tr>
                  <td>degree</td>
                  <td>high_school</td>
                  <td>11261</td>
                  <td>70.4</td>
                  <td>54</td>
                  <td>29.2</td>
                </tr>
                <tr>
                  <td></td>
                  <td>no_high_school</td>
                  <td>4731</td>
                  <td>29.6</td>
                  <td>131</td>
                  <td>70.8</td>
                </tr>
                <tr>
                  <td>marriage</td>
                  <td>married</td>
                  <td>11382</td>
                  <td>71.2</td>
                  <td>35</td>
                  <td>18.9</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unmarried</td>
                  <td>4610</td>
                  <td>28.8</td>
                  <td>150</td>
                  <td>81.1</td>
                </tr>
                <tr>
                  <td>employment74</td>
                  <td>employed</td>
                  <td>14079</td>
                  <td>88.0</td>
                  <td>54</td>
                  <td>29.2</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unemployed</td>
                  <td>1913</td>
                  <td>12.0</td>
                  <td>131</td>
                  <td>70.8</td>
                </tr>
                <tr>
                  <td>employement75</td>
                  <td>employed</td>
                  <td>14244</td>
                  <td>89.1</td>
                  <td>74</td>
                  <td>40.0</td>
                </tr>
                <tr>
                  <td></td>
                  <td>unemployed</td>
                  <td>1748</td>
                  <td>10.9</td>
                  <td>111</td>
                  <td>60.0</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</section>
<section id="e.-1" class="level3">
<h3 class="anchored" data-anchor-id="e.-1">e.</h3>
<p>The CPS controls appear to be very different from the treated group for all the observable characteristics listed above. The raw differences in earnings78 can not be interpreted as the average treatment effect as there is likely to be a selection bias and other characteristics such as race and education are likely to confound the treatment effect estimate.</p>
</section>
</section>
<section id="exercise-4" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4">Exercise 4</h2>
<section id="a.-3" class="level3">
<h3 class="anchored" data-anchor-id="a.-3">a.</h3>
<p>The estimated treatment effect is $1066 when regressing earnings on treatment status and covariates in the composite dataset with a p-value of 0.054. This suggest weak evidence of a positive effect. However, the average treatment effect obtained from the randomised experiment is larger ($1794) and statistically significant at 5% significant level as shown in 2.c.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(earnings78<span class="sc">~</span>., composite)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = earnings78 ~ ., data = composite)

Residuals:
   Min     1Q Median     3Q    Max 
-25010  -3521   1283   3772  53738 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              5.122e+03  4.886e+02  10.483  &lt; 2e-16 ***
treattreated             1.066e+03  5.536e+02   1.926 0.054092 .  
age                     -9.446e+01  5.995e+00 -15.755  &lt; 2e-16 ***
education                1.745e+02  2.867e+01   6.086 1.18e-09 ***
earnings74               2.913e-01  1.274e-02  22.869  &lt; 2e-16 ***
earnings75               4.414e-01  1.286e-02  34.323  &lt; 2e-16 ***
racehispanic             5.794e+02  2.878e+02   2.013 0.044085 *  
racewhite                8.098e+02  2.127e+02   3.808 0.000141 ***
degreeno_high_school     3.411e+02  1.777e+02   1.919 0.054993 .  
marriageunmarried       -1.534e+02  1.427e+02  -1.075 0.282184    
employment74unemployed   3.515e+02  2.315e+02   1.519 0.128845    
employement75unemployed -1.621e+03  2.396e+02  -6.766 1.37e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6993 on 16165 degrees of freedom
Multiple R-squared:  0.4774,    Adjusted R-squared:  0.4771 
F-statistic:  1343 on 11 and 16165 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="b.-3" class="level3">
<h3 class="anchored" data-anchor-id="b.-3">b.</h3>
<p>The assumption of conditional independence is needed. After controlling for observable covariates, treatment assignment must be independent of potential outcomes. This requires that all confounders are observed and included in the model.</p>
</section>
<section id="c.-3" class="level3">
<h3 class="anchored" data-anchor-id="c.-3">c.</h3>
<p>The ATE conditional on covariates is expressed as:</p>
<p><span class="math display">\[
\text{ATE} = \mathbb{E}[Y \mid D = 1, X] - \mathbb{E}[Y \mid D = 0, X]
\]</span></p>
<p>Under <strong>unconfoundedness</strong>, the assignment of the treatment can be seen as random. Hence, D is mean independent of <span class="math inline">\((Y_0, Y_1)\)</span>, we can write ATE over the full populatioon as:</p>
<p><span class="math display">\[
\text{ATE} = \mathbb{E}[\mathbb{E}[Y_1 \mid X] - \mathbb{E}[Y_0 \mid X]]
\]</span></p>
<p>Using the linear conditional expectations above:</p>
<p><span class="math display">\[
\mathbb{E}[Y_1 \mid X] = \alpha_1 + X' \beta_1 \\
\mathbb{E}[Y_0 \mid X] = \alpha_0 + X' \beta_0
\]</span></p>
<p>So,</p>
<p><span class="math display">\[
\mathbb{E}[Y_1 \mid X] - \mathbb{E}[Y_0 \mid X] = (\alpha_1 - \alpha_0) + X'(\beta_1 - \beta_0)
\]</span></p>
<p>Now take the <strong>expectation over the distribution of</strong> ( X ):</p>
<p><span class="math display">\[
\text{ATE} = (\alpha_1 - \alpha_0) + \mathbb{E}[X'](\beta_1 - \beta_0)
\]</span></p>
</section>
<section id="d.-2" class="level3">
<h3 class="anchored" data-anchor-id="d.-2">d.</h3>
<p>We are given that the conditional expectation of the potential outcomes is:</p>
<p><span class="math display">\[
\mathbb{E}[Y_d \mid X] = \alpha_d + X' \beta_d \quad \text{for } d = 0,1
\]</span></p>
<p>Using the switching equation:</p>
<p><span class="math display">\[
Y = D \cdot Y_1 + (1 - D) \cdot Y_0,
\]</span></p>
<p>we can compute:</p>
<p><span class="math display">\[
\mathbb{E}[Y \mid D, X] = D \cdot (\alpha_1 + X' \beta_1) + (1 - D)(\alpha_0 + X' \beta_0)
\]</span></p>
<p>Expanding this, we get:</p>
<p><span class="math display">\[
\mathbb{E}[Y \mid D, X] = \alpha_0 + X' \beta_0 + D \cdot \left[(\alpha_1 - \alpha_0) + X'(\beta_1 - \beta_0)\right]
\]</span> Therefore, we should run a regression to estimate ATE as follows:</p>
<p><span class="math display">\[
Y = \alpha + \tau D + X' \gamma + \varepsilon
\]</span> Additional assumptions:<br>
(1) It is a linear model.<br>
(2) Unconfoundedness: <span class="math inline">\((Y_0, Y_1) \perp\!\!\!\perp D \mid X\)</span></p>
</section>
</section>
<section id="exercise-5" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5">Exercise 5</h2>
<section id="a.-4" class="level3">
<h3 class="anchored" data-anchor-id="a.-4">a.</h3>
<p>In the propensity score model, we should exclude earnings78 from the list of covariates because it is a post-treatment outcome variable. Including it would introduce post-treatment bias, violating the assumption that the propensity score is based solely on pre-treatment characteristics. Only covariates determined before treatment assignment should be included when estimating the propensity score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>logit_data <span class="ot">&lt;-</span> composite <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat =</span> <span class="fu">ifelse</span>(treat <span class="sc">==</span> <span class="st">"treated"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert categorical vars to factor first</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">as.factor</span>(race),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">degree =</span> <span class="fu">as.factor</span>(degree),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">marriage =</span> <span class="fu">as.factor</span>(marriage),</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">employment74 =</span> <span class="fu">as.factor</span>(employment74),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">employement75 =</span> <span class="fu">as.factor</span>(employement75)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(treat<span class="sc">~</span>.<span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span> earnings78, <span class="at">data =</span> logit_data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = treat ~ . - 1 - earnings78, family = binomial(link = "logit"), 
    data = logit_data)

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
age                     -1.790e-02  1.064e-02  -1.683 0.092421 .  
education                1.949e-02  4.859e-02   0.401 0.688381    
earnings74               6.253e-05  2.845e-05   2.197 0.027990 *  
earnings75              -1.773e-04  3.600e-05  -4.923 8.51e-07 ***
raceblack               -3.049e+00  8.383e-01  -3.637 0.000275 ***
racehispanic            -5.500e+00  8.721e-01  -6.306 2.86e-10 ***
racewhite               -7.335e+00  8.716e-01  -8.416  &lt; 2e-16 ***
degreeno_high_school     9.028e-01  2.751e-01   3.282 0.001031 ** 
marriageunmarried        9.943e-01  2.413e-01   4.120 3.79e-05 ***
employment74unemployed   1.572e+00  2.639e-01   5.956 2.58e-09 ***
employement75unemployed  2.347e-01  2.386e-01   0.984 0.325164    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 22426.08  on 16177  degrees of freedom
Residual deviance:   950.45  on 16166  degrees of freedom
AIC: 972.45

Number of Fisher Scoring iterations: 10</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>logit_data <span class="ot">&lt;-</span> <span class="fu">augment</span>(reg2, <span class="at">type.predict =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">propensity_score =</span> .fitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-4" class="level3">
<h3 class="anchored" data-anchor-id="b.-4">b.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>treated <span class="ot">&lt;-</span> logit_data <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treat <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(treated, <span class="fu">aes</span>(<span class="at">x =</span> propensity_score)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Propensity Score Distributions for the treated group"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Propensity Score"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PS2_NSW_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> logit_data <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(treat <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(control, <span class="fu">aes</span>(<span class="at">x =</span> propensity_score)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Propensity Score Distributions for the control group"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Propensity Score"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="PS2_NSW_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extra summary statistics</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>logit_data <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treat) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_ps =</span> <span class="fu">mean</span>(propensity_score),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_ps =</span> <span class="fu">sd</span>(propensity_score),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_ps =</span> <span class="fu">min</span>(propensity_score),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_ps =</span> <span class="fu">max</span>(propensity_score)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  treat mean_ps  sd_ps     min_ps max_ps
  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
1     0 0.00785 0.0434 0.00000470  0.638
2     1 0.322   0.226  0.000512    0.633</code></pre>
</div>
</div>
<p>The result highlights the substantial difference in the distribution of propensity scores for the control and treated group. The histogram of the control group’s propensity scores shows an extreme concentration near 0, while the treated group’s scores are widely distributed between 0 and 0.65. This means people in the treated group are more likely to receive treatment than the control group, which suggests substantial differences in observed covariates between groups.</p>
</section>
<section id="c.-4" class="level3">
<h3 class="anchored" data-anchor-id="c.-4">c.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute IPW weights</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>logit_data <span class="ot">&lt;-</span> logit_data <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_treat =</span> treat <span class="sc">/</span> propensity_score,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_control =</span> (<span class="dv">1</span> <span class="sc">-</span> treat) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> propensity_score)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute psw</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>psw_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  logit_data<span class="sc">$</span>weight_treat <span class="sc">*</span> logit_data<span class="sc">$</span>earnings78 <span class="sc">-</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  logit_data<span class="sc">$</span>weight_control <span class="sc">*</span> logit_data<span class="sc">$</span>earnings78</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>psw_estimate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -10548.41</code></pre>
</div>
</div>
</section>
<section id="d.-3" class="level3">
<h3 class="anchored" data-anchor-id="d.-3">d.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Trim observations with extreme propensity scores</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>logit_trimmed <span class="ot">&lt;-</span> logit_data <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(propensity_score <span class="sc">&gt;=</span> <span class="fl">0.1</span>, propensity_score <span class="sc">&lt;=</span> <span class="fl">0.9</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute psw</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>logit_trimmed <span class="ot">&lt;-</span> logit_trimmed <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_treat =</span> treat <span class="sc">/</span> propensity_score,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">weight_control =</span> (<span class="dv">1</span> <span class="sc">-</span> treat) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> propensity_score)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Compute trimmed psw estimator</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>psw_estimator_trimmed <span class="ot">&lt;-</span> <span class="fu">mean</span>(</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  logit_trimmed<span class="sc">$</span>weight_treat <span class="sc">*</span> logit_trimmed<span class="sc">$</span>earnings78 <span class="sc">-</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  logit_trimmed<span class="sc">$</span>weight_control <span class="sc">*</span> logit_trimmed<span class="sc">$</span>earnings78</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>psw_estimator_trimmed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2047.641</code></pre>
</div>
</div>
</section>
<section id="e.-2" class="level3">
<h3 class="anchored" data-anchor-id="e.-2">e.</h3>
<p>The difference between parts (c) and (d) arises from the presence of extreme propensity scores in the untrimmed sample. In part (c), these lead to very large inverse weights, especially among control units with scores near 0. This results in a highly volatile and unreliable ATE estimate. In contrast, part (d) trims these problematic observations and ensures that only observations with sufficient overlap are used for causal inference, where treated and control units are more comparable. This produces a much more stable and credible estimate of the treatment effect.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>